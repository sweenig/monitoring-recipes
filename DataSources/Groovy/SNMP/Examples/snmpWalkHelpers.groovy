/*******************************************************************************
 *  Â© 2007-2019 - LogicMonitor, Inc. All rights reserved.
 ******************************************************************************/
//single term examples
Oid = "1.3.6.1.2.1.2.2.1" //polling the interfaces table (returns "metricOID.wildvalue = datavalue")
//Oid = "1.3.6.1.2.1.2.2.1.2" //polling the interfaces table for one column (returns "wildvalue = datavalue")
//Oid = "1.3.6.1.2.1" //polling an entire tree
wildvalueTerms = 1

//multiple term examples
//Oid = "1.3.6.1.4.1.34086.2.2.17.3.1.1"
//wildvalueTerms = 2

import com.santaba.agent.groovyapi.snmp.Snmp

def host = hostProps.get('system.hostname')
def props = hostProps.toProperties()
int timeout = 10000 // 10 sec timeout.

def snmpMapToTable(snmpmap, int wildvalueTerms = 1) {
    //println("Raw result of snmpwalk of ${Oid}:\n${snmpmap}\n${"=".multiply(80)}")
    rows = [:]
    snmpmap.each {k,v ->
        splits = k.tokenize(".")
        col = splits.dropRight(wildvalueTerms).join(".")
        wildvalue = splits.takeRight(wildvalueTerms).join(".")
        if (!(rows.containsKey(wildvalue))) { rows[wildvalue] = [:] }
        rows[wildvalue][col] = v
    }
    return rows
}

def sortSnmpWalkTable(table, int wildvalueTerms = 1) {
    if (wildvalueTerms > 2) {
        println("More than 2 terms in the wildvalue are not supported.");
        return [];
    }
    if (wildvalueTerms == 1) {
        rowsWildvalueSorted = table.keySet().collect { it.toInteger() }.sort()
    } else {
        rowsWildvalueSorted = table.keySet().collect { Float.parseFloat(it)}.sort()
    }
    return rowsWildvalueSorted
}

def sortDataKeys(data){
    if (data.keySet().size() > 1){ //if there is more than one data point per wildvalue
        if (data.keySet()[0].tokenize(".").size() > 1){return data.keySet()} //if there is more than one term in the data key
        else {
            println("Data sorted by column ID")
            return data.keySet().collect { it.toInteger() }.sort().collect{it.toString()}
        }
    } else {return data.keySet()}
}

def pprintSnmpWalkTable(table) {
    if (table.size() == 0) {
        println("No data returned.")
    } else {
        sortSnmpWalkTable(table).each { k ->
            println("Wildvalue: ${k.toString()}:")
            data = table[k.toString()]
            sortDataKeys(data).each {println("  ${it ?: Oid.tokenize(".")[-1]}.${"##"+"WILDVALUE"+"##"}: ${data[it]}")}
        }
    }
}

def flattenSnmpWalkTable(table) {
    flat = []
    sortSnmpWalkTable(table).each { k ->
        data = table[k.toString()].each {key, val ->
            flat << [k,key, val]
        }
    }
    return flat
}

def snmpWalkToCsv(table) {
    colHeaders = table[table.keySet()[0]].keySet().collect{it.toInteger()}.sort()
    output = "idx," + colHeaders.join(",")
    table.each{k,v ->
        line=[k]
        colHeaders.each{ col ->
          line += v[col.toString()]
        }
        output += line.join(",")
    }
    return output
}

walkResult = Snmp.walkAsMap(host, Oid, props, timeout)
entryRaw = snmpMapToTable(walkResult, wildvalueTerms)
println("Raw Result:\n" + "=".multiply(80))
println(walkResult)
println("=".multiply(80) + "\n")

println("Converted to table:\n" + "=".multiply(80))
println(entryRaw)
println("=".multiply(80) + "\n")

println("Pretty printed:\n" + "=".multiply(80))
pprintSnmpWalkTable(entryRaw)
println("=".multiply(80) + "\n")

println("Flattened:\n" + "=".multiply(80))
flattenSnmpWalkTable(entryRaw).each{println(it)}
println("=".multiply(80) + "\n")

println("Converted to CSV:\n" + "=".multiply(80))
println(snmpWalkToCsv(entryRaw))
println("=".multiply(80) + "\n")

return 0

/*******************************************************************************
* Sample output against my machine
********************************************************************************
Raw Result:
================================================================================
[8.6:1, 4.10:1500, 8.7:1, 8.8:1, 4.12:1500, 8.9:2, 4.14:1500, 11.20:1135008, 4.16:1500, 11.22:237753, 9.20:0:04:03.11, 9.22:0:04:15.11, 22.5:0.0, 22.4:0.0, 22.3:0.0, 22.2:0.0, 22.1:0.0, 22.9:0.0, 22.8:0.0, 22.7:0.0, 22.6:0.0, 4.20:1500, 17.16:112533, 4.22:1500, 17.18:638367, 17.12:3147, 18.9:0, 18.8:0, 17.14:29860, 18.7:0, 17.10:279091, 10.6:2054355, 10.5:56340357, 10.4:0, 10.3:0, 10.2:2228352644, 10.1:3162190286, 18.6:0, 4.18:1500, 18.5:0, 7.1:1, 18.4:0, 7.2:1, 18.3:0, 7.3:1, 18.2:0, 7.4:2, 10.9:0, 18.1:0, 7.5:1, 10.8:619193909, 7.6:1, 10.7:0, 7.7:1, 7.8:1, 16.12:429025, 7.9:1, 16.10:52821619, 16.16:9816144, 16.14:2817234, 22.14:0.0, 22.16:0.0, 22.18:0.0, 21.6:0, 21.5:0, 21.4:0, 21.3:0, 21.2:0, 21.1:0, 22.10:0.0, 22.12:0.0, 16.18:267278626, 21.9:0, 21.8:0, 21.7:0, 5.10:0, 5.12:4294967295, 16.22:52865894, 5.14:4294967295, 11.10:237753, 5.16:4294967295, 11.12:0, 17.9:0, 17.8:1296045, 16.20:267479252, 22.20:0.0, 22.22:0.0, 11.14:29493, 17.7:2669, 6.1:, 17.6:29543, 6.2:90:e6:ba:59:1b:18, 11.16:101171, 17.5:112215, 6.3:52:54:00:9b:4b:e0, 17.4:0, 6.4:52:54:00:9b:4b:e0, 11.18:1104229, 17.3:0, 6.5:02:42:ca:b3:57:b4, 17.2:6119330, 6.6:02:42:9f:fd:92:94, 17.1:1989856, 6.7:02:42:06:b4:62:93, 6.8:02:42:08:61:d9:06, 5.22:4294967295, 6.9:02:42:13:0a:d8:d8, 15.22:0, 15.20:0, 10.10:74053215, 5.20:4294967295, 20.7:0, 20.6:0, 20.5:0, 20.4:0, 20.3:0, 20.2:0, 20.1:0, 5.18:4294967295, 21.22:0, 10.12:0, 21.20:0, 10.14:2467257, 10.16:57756751, 20.9:0, 10.18:325461517, 20.8:0, 10.20:325081710, 10.22:77381757, 16.9:0, 5.1:10000000, 16.8:534325193, 5.2:100000000, 16.7:371278, 5.3:0, 16.6:2773029, 5.4:10000000, 16.5:9771869, 5.5:0, 16.4:0, 5.6:0, 16.3:0, 5.7:0, 16.2:1270990055, 5.8:0, 16.1:3162190286, 5.9:0, 6.12:e6:ec:86:ac:8e:39, 6.14:aa:7a:45:ff:6a:9d, 6.16:b2:b5:47:2f:9b:ff, 6.18:9a:f5:00:f8:20:49, 6.10:02:42:8b:1f:df:38, 15.12:0, 6.22:62:b4:9a:7a:ab:b4, 21.18:0, 15.10:0, 21.16:0, 15.16:0, 21.14:0, 15.14:0, 21.12:0, 1.12:12, 1.10:10, 6.20:5a:85:39:ab:f3:74, 15.1:0, 4.1:65536, 4.2:1500, 15.9:0, 4.3:1500, 15.8:0, 21.10:0, 4.4:1500, 15.7:0, 15.18:0, 4.5:1500, 15.6:0, 4.6:1500, 15.5:0, 4.7:1500, 15.4:0, 4.8:1500, 15.3:0, 4.9:1500, 15.2:0, 14.10:0, 20.18:0, 20.16:0, 14.14:0, 20.14:0, 14.12:0, 20.12:0, 19.20:0, 1.22:22, 19.22:0, 1.20:20, 1.18:18, 1.16:16, 1.14:14, 14.18:0, 20.10:0, 14.16:0, 7.12:1, 14.22:0, 7.14:1, 14.20:0, 7.16:1, 7.18:1, 20.22:0, 7.10:1, 14.2:0, 14.1:0, 3.1:24, 3.2:6, 3.3:6, 3.4:6, 14.9:0, 20.20:0, 3.5:6, 14.8:0, 3.6:6, 14.7:0, 3.7:6, 14.6:0, 3.8:6, 14.5:0, 3.9:6, 14.4:0, 14.3:0, 13.20:0, 13.22:0, 2.14:veth0e23123, 2.12:vethef620e8, 2.10:br-d49ce70143f7, 7.20:1, 7.22:1, 19.18:0, 19.14:0, 19.16:0, 19.10:0, 19.12:0, 2.22:veth697a876, 2.20:vethbfefa92, 13.3:0, 13.2:0, 13.1:0, 2.18:veth303d00d, 2.1:lo, 2.2:NVIDIA Corporation MCP77 Ethernet, 2.16:vethdf6bad9, 2.3:virbr0, 2.4:virbr0-nic, 2.5:br-ee99fe372436, 2.6:br-35600906bbec, 13.9:0, 2.7:br-4b253b6accd1, 13.8:0, 2.8:br-6a2604a91ac1, 13.7:0, 2.9:docker0, 13.6:0, 13.5:0, 13.4:0, 18.16:0, 8.16:1, 18.18:0, 8.14:1, 18.12:0, 18.14:0, 8.18:1, 18.10:0, 8.12:1, 8.10:1, 13.10:0, 13.14:0, 13.12:0, 3.14:6, 18.20:0, 3.12:6, 18.22:0, 8.22:1, 3.10:6, 8.20:1, 12.4:0, 12.3:0, 12.2:308678, 12.1:0, 1.1:1, 1.2:2, 1.3:3, 1.4:4, 1.5:5, 1.6:6, 13.18:0, 1.7:7, 1.8:8, 12.9:0, 13.16:0, 1.9:9, 9.1:0:00:00.00, 12.8:0, 9.2:0:00:03.05, 12.7:0, 9.3:0:00:06.05, 12.6:0, 9.4:0:00:06.05, 12.5:0, 9.5:0:03:51.11, 9.6:0:03:42.10, 9.7:0:00:24.06, 9.8:0:04:03.11, 9.9:0:00:12.06, 17.22:279409, 12.10:0, 12.12:0, 17.20:660748, 3.22:6, 3.20:6, 3.18:6, 3.16:6, 12.14:0, 12.16:0, 12.18:0, 9.16:0:03:51.11, 9.14:0:03:42.10, 12.20:0, 12.22:0, 19.9:0, 19.8:0, 9.18:0:04:03.11, 19.7:0, 19.6:0, 9.12:0:00:24.06, 9.10:0:04:15.11, 11.5:101171, 11.4:0, 11.3:0, 11.2:5908706, 11.1:1989856, 19.5:0, 19.4:0, 19.3:0, 8.1:1, 19.2:0, 8.2:1, 11.9:0, 19.1:0, 8.3:2, 11.8:2239237, 8.4:2, 11.7:0, 8.5:1, 11.6:29493]
================================================================================

Converted to table:
================================================================================
[6:[8:1, 22:0.0, 10:2054355, 18:0, 7:1, 21:0, 17:29543, 6:02:42:9f:fd:92:94, 20:0, 16:2773029, 5:0, 15:0, 4:1500, 3:6, 14:0, 2:br-35600906bbec, 13:0, 1:6, 12:0, 9:0:03:42.10, 19:0, 11:29493], 10:[4:1500, 17:279091, 16:52821619, 22:0.0, 5:0, 11:237753, 10:74053215, 6:02:42:8b:1f:df:38, 15:0, 1:10, 21:0, 14:0, 20:0, 7:1, 2:br-d49ce70143f7, 19:0, 18:0, 8:1, 13:0, 3:6, 12:0, 9:0:04:15.11], 7:[8:1, 22:0.0, 18:0, 10:0, 7:1, 21:0, 17:2669, 6:02:42:06:b4:62:93, 20:0, 16:371278, 5:0, 15:0, 4:1500, 14:0, 3:6, 2:br-4b253b6accd1, 13:0, 1:7, 12:0, 9:0:00:24.06, 19:0, 11:0], 8:[8:1, 22:0.0, 18:0, 10:619193909, 7:1, 21:0, 17:1296045, 6:02:42:08:61:d9:06, 20:0, 16:534325193, 5:0, 15:0, 4:1500, 14:0, 3:6, 13:0, 2:br-6a2604a91ac1, 1:8, 12:0, 9:0:04:03.11, 19:0, 11:2239237], 12:[4:1500, 17:3147, 16:429025, 22:0.0, 5:4294967295, 11:0, 10:0, 6:e6:ec:86:ac:8e:39, 15:0, 21:0, 1:12, 14:0, 20:0, 7:1, 2:vethef620e8, 19:0, 18:0, 8:1, 13:0, 3:6, 12:0, 9:0:00:24.06], 9:[8:2, 22:0.0, 18:0, 10:0, 7:1, 21:0, 17:0, 6:02:42:13:0a:d8:d8, 20:0, 16:0, 5:0, 15:0, 4:1500, 14:0, 3:6, 13:0, 2:docker0, 12:0, 1:9, 9:0:00:12.06, 19:0, 11:0], 14:[4:1500, 17:29860, 16:2817234, 22:0.0, 5:4294967295, 11:29493, 10:2467257, 6:aa:7a:45:ff:6a:9d, 21:0, 15:0, 14:0, 20:0, 1:14, 7:1, 2:veth0e23123, 19:0, 8:1, 18:0, 13:0, 3:6, 12:0, 9:0:03:42.10], 20:[11:1135008, 9:0:04:03.11, 4:1500, 16:267479252, 22:0.0, 15:0, 5:4294967295, 21:0, 10:325081710, 6:5a:85:39:ab:f3:74, 19:0, 1:20, 14:0, 20:0, 13:0, 7:1, 2:vethbfefa92, 18:0, 8:1, 17:660748, 3:6, 12:0], 16:[4:1500, 17:112533, 16:9816144, 22:0.0, 5:4294967295, 11:101171, 10:57756751, 6:b2:b5:47:2f:9b:ff, 21:0, 15:0, 20:0, 1:16, 14:0, 7:1, 19:0, 2:vethdf6bad9, 18:0, 8:1, 13:0, 3:6, 12:0, 9:0:03:51.11], 22:[11:237753, 9:0:04:15.11, 4:1500, 16:52865894, 22:0.0, 5:4294967295, 15:0, 21:0, 10:77381757, 6:62:b4:9a:7a:ab:b4, 1:22, 19:0, 14:0, 20:0, 13:0, 7:1, 2:veth697a876, 18:0, 8:1, 17:279409, 3:6, 12:0], 5:[22:0.0, 10:56340357, 18:0, 7:1, 21:0, 17:112215, 6:02:42:ca:b3:57:b4, 20:0, 16:9771869, 5:0, 4:1500, 15:0, 3:6, 14:0, 2:br-ee99fe372436, 13:0, 1:5, 12:0, 9:0:03:51.11, 11:101171, 19:0, 8:1], 4:[22:0.0, 10:0, 18:0, 7:2, 21:0, 17:0, 6:52:54:00:9b:4b:e0, 20:0, 5:10000000, 16:0, 4:1500, 15:0, 3:6, 14:0, 2:virbr0-nic, 13:0, 12:0, 1:4, 9:0:00:06.05, 11:0, 19:0, 8:2], 3:[22:0.0, 10:0, 18:0, 7:1, 21:0, 6:52:54:00:9b:4b:e0, 17:0, 20:0, 5:0, 16:0, 4:1500, 15:0, 3:6, 14:0, 13:0, 2:virbr0, 12:0, 1:3, 9:0:00:06.05, 11:0, 19:0, 8:2], 2:[22:0.0, 10:2228352644, 7:1, 18:0, 21:0, 6:90:e6:ba:59:1b:18, 17:6119330, 20:0, 5:100000000, 16:1270990055, 4:1500, 15:0, 14:0, 3:6, 13:0, 2:NVIDIA Corporation MCP77 Ethernet, 12:308678, 1:2, 9:0:00:03.05, 11:5908706, 19:0, 8:1], 1:[22:0.0, 10:3162190286, 7:1, 18:0, 21:0, 6:, 17:1989856, 20:0, 5:10000000, 16:3162190286, 15:0, 4:65536, 14:0, 3:24, 13:0, 2:lo, 12:0, 1:1, 9:0:00:00.00, 11:1989856, 8:1, 19:0], 18:[17:638367, 4:1500, 22:0.0, 16:267278626, 11:1104229, 5:4294967295, 10:325461517, 6:9a:f5:00:f8:20:49, 21:0, 15:0, 20:0, 1:18, 14:0, 7:1, 19:0, 2:veth303d00d, 18:0, 8:1, 13:0, 3:6, 12:0, 9:0:04:03.11]]
================================================================================

Pretty printed:
================================================================================
Wildvalue: 1:
Data sorted by column ID
  1.##WILDVALUE##: 1
  2.##WILDVALUE##: lo
  3.##WILDVALUE##: 24
  4.##WILDVALUE##: 65536
  5.##WILDVALUE##: 10000000
  6.##WILDVALUE##:
  7.##WILDVALUE##: 1
  8.##WILDVALUE##: 1
  9.##WILDVALUE##: 0:00:00.00
  10.##WILDVALUE##: 3162190286
  11.##WILDVALUE##: 1989856
  12.##WILDVALUE##: 0
  13.##WILDVALUE##: 0
  14.##WILDVALUE##: 0
  15.##WILDVALUE##: 0
  16.##WILDVALUE##: 3162190286
  17.##WILDVALUE##: 1989856
  18.##WILDVALUE##: 0
  19.##WILDVALUE##: 0
  20.##WILDVALUE##: 0
  21.##WILDVALUE##: 0
  22.##WILDVALUE##: 0.0
Wildvalue: 2:
Data sorted by column ID
  1.##WILDVALUE##: 2
  2.##WILDVALUE##: NVIDIA Corporation MCP77 Ethernet
  3.##WILDVALUE##: 6
  4.##WILDVALUE##: 1500
  5.##WILDVALUE##: 100000000
  6.##WILDVALUE##: 90:e6:ba:59:1b:18
  7.##WILDVALUE##: 1
  8.##WILDVALUE##: 1
  9.##WILDVALUE##: 0:00:03.05
  10.##WILDVALUE##: 2228352644
  11.##WILDVALUE##: 5908706
  12.##WILDVALUE##: 308678
  13.##WILDVALUE##: 0
  14.##WILDVALUE##: 0
  15.##WILDVALUE##: 0
  16.##WILDVALUE##: 1270990055
  17.##WILDVALUE##: 6119330
  18.##WILDVALUE##: 0
  19.##WILDVALUE##: 0
  20.##WILDVALUE##: 0
  21.##WILDVALUE##: 0
  22.##WILDVALUE##: 0.0
Wildvalue: 3:
Data sorted by column ID
  1.##WILDVALUE##: 3
  2.##WILDVALUE##: virbr0
  3.##WILDVALUE##: 6
  4.##WILDVALUE##: 1500
  5.##WILDVALUE##: 0
  6.##WILDVALUE##: 52:54:00:9b:4b:e0
  7.##WILDVALUE##: 1
  8.##WILDVALUE##: 2
  9.##WILDVALUE##: 0:00:06.05
  10.##WILDVALUE##: 0
  11.##WILDVALUE##: 0
  12.##WILDVALUE##: 0
  13.##WILDVALUE##: 0
  14.##WILDVALUE##: 0
  15.##WILDVALUE##: 0
  16.##WILDVALUE##: 0
  17.##WILDVALUE##: 0
  18.##WILDVALUE##: 0
  19.##WILDVALUE##: 0
  20.##WILDVALUE##: 0
  21.##WILDVALUE##: 0
  22.##WILDVALUE##: 0.0
Wildvalue: 4:
Data sorted by column ID
  1.##WILDVALUE##: 4
  2.##WILDVALUE##: virbr0-nic
  3.##WILDVALUE##: 6
  4.##WILDVALUE##: 1500
  5.##WILDVALUE##: 10000000
  6.##WILDVALUE##: 52:54:00:9b:4b:e0
  7.##WILDVALUE##: 2
  8.##WILDVALUE##: 2
  9.##WILDVALUE##: 0:00:06.05
  10.##WILDVALUE##: 0
  11.##WILDVALUE##: 0
  12.##WILDVALUE##: 0
  13.##WILDVALUE##: 0
  14.##WILDVALUE##: 0
  15.##WILDVALUE##: 0
  16.##WILDVALUE##: 0
  17.##WILDVALUE##: 0
  18.##WILDVALUE##: 0
  19.##WILDVALUE##: 0
  20.##WILDVALUE##: 0
  21.##WILDVALUE##: 0
  22.##WILDVALUE##: 0.0
Wildvalue: 5:
Data sorted by column ID
  1.##WILDVALUE##: 5
  2.##WILDVALUE##: br-ee99fe372436
  3.##WILDVALUE##: 6
  4.##WILDVALUE##: 1500
  5.##WILDVALUE##: 0
  6.##WILDVALUE##: 02:42:ca:b3:57:b4
  7.##WILDVALUE##: 1
  8.##WILDVALUE##: 1
  9.##WILDVALUE##: 0:03:51.11
  10.##WILDVALUE##: 56340357
  11.##WILDVALUE##: 101171
  12.##WILDVALUE##: 0
  13.##WILDVALUE##: 0
  14.##WILDVALUE##: 0
  15.##WILDVALUE##: 0
  16.##WILDVALUE##: 9771869
  17.##WILDVALUE##: 112215
  18.##WILDVALUE##: 0
  19.##WILDVALUE##: 0
  20.##WILDVALUE##: 0
  21.##WILDVALUE##: 0
  22.##WILDVALUE##: 0.0
Wildvalue: 6:
Data sorted by column ID
  1.##WILDVALUE##: 6
  2.##WILDVALUE##: br-35600906bbec
  3.##WILDVALUE##: 6
  4.##WILDVALUE##: 1500
  5.##WILDVALUE##: 0
  6.##WILDVALUE##: 02:42:9f:fd:92:94
  7.##WILDVALUE##: 1
  8.##WILDVALUE##: 1
  9.##WILDVALUE##: 0:03:42.10
  10.##WILDVALUE##: 2054355
  11.##WILDVALUE##: 29493
  12.##WILDVALUE##: 0
  13.##WILDVALUE##: 0
  14.##WILDVALUE##: 0
  15.##WILDVALUE##: 0
  16.##WILDVALUE##: 2773029
  17.##WILDVALUE##: 29543
  18.##WILDVALUE##: 0
  19.##WILDVALUE##: 0
  20.##WILDVALUE##: 0
  21.##WILDVALUE##: 0
  22.##WILDVALUE##: 0.0
Wildvalue: 7:
Data sorted by column ID
  1.##WILDVALUE##: 7
  2.##WILDVALUE##: br-4b253b6accd1
  3.##WILDVALUE##: 6
  4.##WILDVALUE##: 1500
  5.##WILDVALUE##: 0
  6.##WILDVALUE##: 02:42:06:b4:62:93
  7.##WILDVALUE##: 1
  8.##WILDVALUE##: 1
  9.##WILDVALUE##: 0:00:24.06
  10.##WILDVALUE##: 0
  11.##WILDVALUE##: 0
  12.##WILDVALUE##: 0
  13.##WILDVALUE##: 0
  14.##WILDVALUE##: 0
  15.##WILDVALUE##: 0
  16.##WILDVALUE##: 371278
  17.##WILDVALUE##: 2669
  18.##WILDVALUE##: 0
  19.##WILDVALUE##: 0
  20.##WILDVALUE##: 0
  21.##WILDVALUE##: 0
  22.##WILDVALUE##: 0.0
Wildvalue: 8:
Data sorted by column ID
  1.##WILDVALUE##: 8
  2.##WILDVALUE##: br-6a2604a91ac1
  3.##WILDVALUE##: 6
  4.##WILDVALUE##: 1500
  5.##WILDVALUE##: 0
  6.##WILDVALUE##: 02:42:08:61:d9:06
  7.##WILDVALUE##: 1
  8.##WILDVALUE##: 1
  9.##WILDVALUE##: 0:04:03.11
  10.##WILDVALUE##: 619193909
  11.##WILDVALUE##: 2239237
  12.##WILDVALUE##: 0
  13.##WILDVALUE##: 0
  14.##WILDVALUE##: 0
  15.##WILDVALUE##: 0
  16.##WILDVALUE##: 534325193
  17.##WILDVALUE##: 1296045
  18.##WILDVALUE##: 0
  19.##WILDVALUE##: 0
  20.##WILDVALUE##: 0
  21.##WILDVALUE##: 0
  22.##WILDVALUE##: 0.0
Wildvalue: 9:
Data sorted by column ID
  1.##WILDVALUE##: 9
  2.##WILDVALUE##: docker0
  3.##WILDVALUE##: 6
  4.##WILDVALUE##: 1500
  5.##WILDVALUE##: 0
  6.##WILDVALUE##: 02:42:13:0a:d8:d8
  7.##WILDVALUE##: 1
  8.##WILDVALUE##: 2
  9.##WILDVALUE##: 0:00:12.06
  10.##WILDVALUE##: 0
  11.##WILDVALUE##: 0
  12.##WILDVALUE##: 0
  13.##WILDVALUE##: 0
  14.##WILDVALUE##: 0
  15.##WILDVALUE##: 0
  16.##WILDVALUE##: 0
  17.##WILDVALUE##: 0
  18.##WILDVALUE##: 0
  19.##WILDVALUE##: 0
  20.##WILDVALUE##: 0
  21.##WILDVALUE##: 0
  22.##WILDVALUE##: 0.0
Wildvalue: 10:
Data sorted by column ID
  1.##WILDVALUE##: 10
  2.##WILDVALUE##: br-d49ce70143f7
  3.##WILDVALUE##: 6
  4.##WILDVALUE##: 1500
  5.##WILDVALUE##: 0
  6.##WILDVALUE##: 02:42:8b:1f:df:38
  7.##WILDVALUE##: 1
  8.##WILDVALUE##: 1
  9.##WILDVALUE##: 0:04:15.11
  10.##WILDVALUE##: 74053215
  11.##WILDVALUE##: 237753
  12.##WILDVALUE##: 0
  13.##WILDVALUE##: 0
  14.##WILDVALUE##: 0
  15.##WILDVALUE##: 0
  16.##WILDVALUE##: 52821619
  17.##WILDVALUE##: 279091
  18.##WILDVALUE##: 0
  19.##WILDVALUE##: 0
  20.##WILDVALUE##: 0
  21.##WILDVALUE##: 0
  22.##WILDVALUE##: 0.0
Wildvalue: 12:
Data sorted by column ID
  1.##WILDVALUE##: 12
  2.##WILDVALUE##: vethef620e8
  3.##WILDVALUE##: 6
  4.##WILDVALUE##: 1500
  5.##WILDVALUE##: 4294967295
  6.##WILDVALUE##: e6:ec:86:ac:8e:39
  7.##WILDVALUE##: 1
  8.##WILDVALUE##: 1
  9.##WILDVALUE##: 0:00:24.06
  10.##WILDVALUE##: 0
  11.##WILDVALUE##: 0
  12.##WILDVALUE##: 0
  13.##WILDVALUE##: 0
  14.##WILDVALUE##: 0
  15.##WILDVALUE##: 0
  16.##WILDVALUE##: 429025
  17.##WILDVALUE##: 3147
  18.##WILDVALUE##: 0
  19.##WILDVALUE##: 0
  20.##WILDVALUE##: 0
  21.##WILDVALUE##: 0
  22.##WILDVALUE##: 0.0
Wildvalue: 14:
Data sorted by column ID
  1.##WILDVALUE##: 14
  2.##WILDVALUE##: veth0e23123
  3.##WILDVALUE##: 6
  4.##WILDVALUE##: 1500
  5.##WILDVALUE##: 4294967295
  6.##WILDVALUE##: aa:7a:45:ff:6a:9d
  7.##WILDVALUE##: 1
  8.##WILDVALUE##: 1
  9.##WILDVALUE##: 0:03:42.10
  10.##WILDVALUE##: 2467257
  11.##WILDVALUE##: 29493
  12.##WILDVALUE##: 0
  13.##WILDVALUE##: 0
  14.##WILDVALUE##: 0
  15.##WILDVALUE##: 0
  16.##WILDVALUE##: 2817234
  17.##WILDVALUE##: 29860
  18.##WILDVALUE##: 0
  19.##WILDVALUE##: 0
  20.##WILDVALUE##: 0
  21.##WILDVALUE##: 0
  22.##WILDVALUE##: 0.0
Wildvalue: 16:
Data sorted by column ID
  1.##WILDVALUE##: 16
  2.##WILDVALUE##: vethdf6bad9
  3.##WILDVALUE##: 6
  4.##WILDVALUE##: 1500
  5.##WILDVALUE##: 4294967295
  6.##WILDVALUE##: b2:b5:47:2f:9b:ff
  7.##WILDVALUE##: 1
  8.##WILDVALUE##: 1
  9.##WILDVALUE##: 0:03:51.11
  10.##WILDVALUE##: 57756751
  11.##WILDVALUE##: 101171
  12.##WILDVALUE##: 0
  13.##WILDVALUE##: 0
  14.##WILDVALUE##: 0
  15.##WILDVALUE##: 0
  16.##WILDVALUE##: 9816144
  17.##WILDVALUE##: 112533
  18.##WILDVALUE##: 0
  19.##WILDVALUE##: 0
  20.##WILDVALUE##: 0
  21.##WILDVALUE##: 0
  22.##WILDVALUE##: 0.0
Wildvalue: 18:
Data sorted by column ID
  1.##WILDVALUE##: 18
  2.##WILDVALUE##: veth303d00d
  3.##WILDVALUE##: 6
  4.##WILDVALUE##: 1500
  5.##WILDVALUE##: 4294967295
  6.##WILDVALUE##: 9a:f5:00:f8:20:49
  7.##WILDVALUE##: 1
  8.##WILDVALUE##: 1
  9.##WILDVALUE##: 0:04:03.11
  10.##WILDVALUE##: 325461517
  11.##WILDVALUE##: 1104229
  12.##WILDVALUE##: 0
  13.##WILDVALUE##: 0
  14.##WILDVALUE##: 0
  15.##WILDVALUE##: 0
  16.##WILDVALUE##: 267278626
  17.##WILDVALUE##: 638367
  18.##WILDVALUE##: 0
  19.##WILDVALUE##: 0
  20.##WILDVALUE##: 0
  21.##WILDVALUE##: 0
  22.##WILDVALUE##: 0.0
Wildvalue: 20:
Data sorted by column ID
  1.##WILDVALUE##: 20
  2.##WILDVALUE##: vethbfefa92
  3.##WILDVALUE##: 6
  4.##WILDVALUE##: 1500
  5.##WILDVALUE##: 4294967295
  6.##WILDVALUE##: 5a:85:39:ab:f3:74
  7.##WILDVALUE##: 1
  8.##WILDVALUE##: 1
  9.##WILDVALUE##: 0:04:03.11
  10.##WILDVALUE##: 325081710
  11.##WILDVALUE##: 1135008
  12.##WILDVALUE##: 0
  13.##WILDVALUE##: 0
  14.##WILDVALUE##: 0
  15.##WILDVALUE##: 0
  16.##WILDVALUE##: 267479252
  17.##WILDVALUE##: 660748
  18.##WILDVALUE##: 0
  19.##WILDVALUE##: 0
  20.##WILDVALUE##: 0
  21.##WILDVALUE##: 0
  22.##WILDVALUE##: 0.0
Wildvalue: 22:
Data sorted by column ID
  1.##WILDVALUE##: 22
  2.##WILDVALUE##: veth697a876
  3.##WILDVALUE##: 6
  4.##WILDVALUE##: 1500
  5.##WILDVALUE##: 4294967295
  6.##WILDVALUE##: 62:b4:9a:7a:ab:b4
  7.##WILDVALUE##: 1
  8.##WILDVALUE##: 1
  9.##WILDVALUE##: 0:04:15.11
  10.##WILDVALUE##: 77381757
  11.##WILDVALUE##: 237753
  12.##WILDVALUE##: 0
  13.##WILDVALUE##: 0
  14.##WILDVALUE##: 0
  15.##WILDVALUE##: 0
  16.##WILDVALUE##: 52865894
  17.##WILDVALUE##: 279409
  18.##WILDVALUE##: 0
  19.##WILDVALUE##: 0
  20.##WILDVALUE##: 0
  21.##WILDVALUE##: 0
  22.##WILDVALUE##: 0.0
================================================================================

Flattened:
================================================================================
[1, 22, 0.0]
[1, 10, 3162190286]
[1, 7, 1]
[1, 18, 0]
[1, 21, 0]
[1, 6, ]
[1, 17, 1989856]
[1, 20, 0]
[1, 5, 10000000]
[1, 16, 3162190286]
[1, 15, 0]
[1, 4, 65536]
[1, 14, 0]
[1, 3, 24]
[1, 13, 0]
[1, 2, lo]
[1, 12, 0]
[1, 1, 1]
[1, 9, 0:00:00.00]
[1, 11, 1989856]
[1, 8, 1]
[1, 19, 0]
[2, 22, 0.0]
[2, 10, 2228352644]
[2, 7, 1]
[2, 18, 0]
[2, 21, 0]
[2, 6, 90:e6:ba:59:1b:18]
[2, 17, 6119330]
[2, 20, 0]
[2, 5, 100000000]
[2, 16, 1270990055]
[2, 4, 1500]
[2, 15, 0]
[2, 14, 0]
[2, 3, 6]
[2, 13, 0]
[2, 2, NVIDIA Corporation MCP77 Ethernet]
[2, 12, 308678]
[2, 1, 2]
[2, 9, 0:00:03.05]
[2, 11, 5908706]
[2, 19, 0]
[2, 8, 1]
[3, 22, 0.0]
[3, 10, 0]
[3, 18, 0]
[3, 7, 1]
[3, 21, 0]
[3, 6, 52:54:00:9b:4b:e0]
[3, 17, 0]
[3, 20, 0]
[3, 5, 0]
[3, 16, 0]
[3, 4, 1500]
[3, 15, 0]
[3, 3, 6]
[3, 14, 0]
[3, 13, 0]
[3, 2, virbr0]
[3, 12, 0]
[3, 1, 3]
[3, 9, 0:00:06.05]
[3, 11, 0]
[3, 19, 0]
[3, 8, 2]
[4, 22, 0.0]
[4, 10, 0]
[4, 18, 0]
[4, 7, 2]
[4, 21, 0]
[4, 17, 0]
[4, 6, 52:54:00:9b:4b:e0]
[4, 20, 0]
[4, 5, 10000000]
[4, 16, 0]
[4, 4, 1500]
[4, 15, 0]
[4, 3, 6]
[4, 14, 0]
[4, 2, virbr0-nic]
[4, 13, 0]
[4, 12, 0]
[4, 1, 4]
[4, 9, 0:00:06.05]
[4, 11, 0]
[4, 19, 0]
[4, 8, 2]
[5, 22, 0.0]
[5, 10, 56340357]
[5, 18, 0]
[5, 7, 1]
[5, 21, 0]
[5, 17, 112215]
[5, 6, 02:42:ca:b3:57:b4]
[5, 20, 0]
[5, 16, 9771869]
[5, 5, 0]
[5, 4, 1500]
[5, 15, 0]
[5, 3, 6]
[5, 14, 0]
[5, 2, br-ee99fe372436]
[5, 13, 0]
[5, 1, 5]
[5, 12, 0]
[5, 9, 0:03:51.11]
[5, 11, 101171]
[5, 19, 0]
[5, 8, 1]
[6, 8, 1]
[6, 22, 0.0]
[6, 10, 2054355]
[6, 18, 0]
[6, 7, 1]
[6, 21, 0]
[6, 17, 29543]
[6, 6, 02:42:9f:fd:92:94]
[6, 20, 0]
[6, 16, 2773029]
[6, 5, 0]
[6, 15, 0]
[6, 4, 1500]
[6, 3, 6]
[6, 14, 0]
[6, 2, br-35600906bbec]
[6, 13, 0]
[6, 1, 6]
[6, 12, 0]
[6, 9, 0:03:42.10]
[6, 19, 0]
[6, 11, 29493]
[7, 8, 1]
[7, 22, 0.0]
[7, 18, 0]
[7, 10, 0]
[7, 7, 1]
[7, 21, 0]
[7, 17, 2669]
[7, 6, 02:42:06:b4:62:93]
[7, 20, 0]
[7, 16, 371278]
[7, 5, 0]
[7, 15, 0]
[7, 4, 1500]
[7, 14, 0]
[7, 3, 6]
[7, 2, br-4b253b6accd1]
[7, 13, 0]
[7, 1, 7]
[7, 12, 0]
[7, 9, 0:00:24.06]
[7, 19, 0]
[7, 11, 0]
[8, 8, 1]
[8, 22, 0.0]
[8, 18, 0]
[8, 10, 619193909]
[8, 7, 1]
[8, 21, 0]
[8, 17, 1296045]
[8, 6, 02:42:08:61:d9:06]
[8, 20, 0]
[8, 16, 534325193]
[8, 5, 0]
[8, 15, 0]
[8, 4, 1500]
[8, 14, 0]
[8, 3, 6]
[8, 13, 0]
[8, 2, br-6a2604a91ac1]
[8, 1, 8]
[8, 12, 0]
[8, 9, 0:04:03.11]
[8, 19, 0]
[8, 11, 2239237]
[9, 8, 2]
[9, 22, 0.0]
[9, 18, 0]
[9, 10, 0]
[9, 7, 1]
[9, 21, 0]
[9, 17, 0]
[9, 6, 02:42:13:0a:d8:d8]
[9, 20, 0]
[9, 16, 0]
[9, 5, 0]
[9, 15, 0]
[9, 4, 1500]
[9, 14, 0]
[9, 3, 6]
[9, 13, 0]
[9, 2, docker0]
[9, 12, 0]
[9, 1, 9]
[9, 9, 0:00:12.06]
[9, 19, 0]
[9, 11, 0]
[10, 4, 1500]
[10, 17, 279091]
[10, 16, 52821619]
[10, 22, 0.0]
[10, 5, 0]
[10, 11, 237753]
[10, 10, 74053215]
[10, 6, 02:42:8b:1f:df:38]
[10, 15, 0]
[10, 1, 10]
[10, 21, 0]
[10, 14, 0]
[10, 20, 0]
[10, 7, 1]
[10, 2, br-d49ce70143f7]
[10, 19, 0]
[10, 18, 0]
[10, 8, 1]
[10, 13, 0]
[10, 3, 6]
[10, 12, 0]
[10, 9, 0:04:15.11]
[12, 4, 1500]
[12, 17, 3147]
[12, 16, 429025]
[12, 22, 0.0]
[12, 5, 4294967295]
[12, 11, 0]
[12, 10, 0]
[12, 6, e6:ec:86:ac:8e:39]
[12, 15, 0]
[12, 21, 0]
[12, 1, 12]
[12, 14, 0]
[12, 20, 0]
[12, 7, 1]
[12, 2, vethef620e8]
[12, 19, 0]
[12, 18, 0]
[12, 8, 1]
[12, 13, 0]
[12, 3, 6]
[12, 12, 0]
[12, 9, 0:00:24.06]
[14, 4, 1500]
[14, 17, 29860]
[14, 16, 2817234]
[14, 22, 0.0]
[14, 5, 4294967295]
[14, 11, 29493]
[14, 10, 2467257]
[14, 6, aa:7a:45:ff:6a:9d]
[14, 21, 0]
[14, 15, 0]
[14, 14, 0]
[14, 20, 0]
[14, 1, 14]
[14, 7, 1]
[14, 2, veth0e23123]
[14, 19, 0]
[14, 8, 1]
[14, 18, 0]
[14, 13, 0]
[14, 3, 6]
[14, 12, 0]
[14, 9, 0:03:42.10]
[16, 4, 1500]
[16, 17, 112533]
[16, 16, 9816144]
[16, 22, 0.0]
[16, 5, 4294967295]
[16, 11, 101171]
[16, 10, 57756751]
[16, 6, b2:b5:47:2f:9b:ff]
[16, 21, 0]
[16, 15, 0]
[16, 20, 0]
[16, 1, 16]
[16, 14, 0]
[16, 7, 1]
[16, 19, 0]
[16, 2, vethdf6bad9]
[16, 18, 0]
[16, 8, 1]
[16, 13, 0]
[16, 3, 6]
[16, 12, 0]
[16, 9, 0:03:51.11]
[18, 17, 638367]
[18, 4, 1500]
[18, 22, 0.0]
[18, 16, 267278626]
[18, 11, 1104229]
[18, 5, 4294967295]
[18, 10, 325461517]
[18, 6, 9a:f5:00:f8:20:49]
[18, 21, 0]
[18, 15, 0]
[18, 20, 0]
[18, 1, 18]
[18, 14, 0]
[18, 7, 1]
[18, 19, 0]
[18, 2, veth303d00d]
[18, 18, 0]
[18, 8, 1]
[18, 13, 0]
[18, 3, 6]
[18, 12, 0]
[18, 9, 0:04:03.11]
[20, 11, 1135008]
[20, 9, 0:04:03.11]
[20, 4, 1500]
[20, 16, 267479252]
[20, 22, 0.0]
[20, 15, 0]
[20, 5, 4294967295]
[20, 21, 0]
[20, 10, 325081710]
[20, 6, 5a:85:39:ab:f3:74]
[20, 19, 0]
[20, 1, 20]
[20, 14, 0]
[20, 20, 0]
[20, 13, 0]
[20, 7, 1]
[20, 2, vethbfefa92]
[20, 18, 0]
[20, 8, 1]
[20, 17, 660748]
[20, 3, 6]
[20, 12, 0]
[22, 11, 237753]
[22, 9, 0:04:15.11]
[22, 4, 1500]
[22, 16, 52865894]
[22, 22, 0.0]
[22, 5, 4294967295]
[22, 15, 0]
[22, 21, 0]
[22, 10, 77381757]
[22, 6, 62:b4:9a:7a:ab:b4]
[22, 1, 22]
[22, 19, 0]
[22, 14, 0]
[22, 20, 0]
[22, 13, 0]
[22, 7, 1]
[22, 2, veth697a876]
[22, 18, 0]
[22, 8, 1]
[22, 17, 279409]
[22, 3, 6]
[22, 12, 0]
================================================================================

Converted to CSV:
================================================================================
idx,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,226,6,br-35600906bbec,6,1500,0,02:42:9f:fd:92:94,1,1,0:03:42.10,2054355,29493,0,0,0,0,2773029,29543,0,0,0,0,0.010,10,br-d49ce70143f7,6,1500,0,02:42:8b:1f:df:38,1,1,0:04:15.11,74053215,237753,0,0,0,0,52821619,279091,0,0,0,0,0.07,7,br-4b253b6accd1,6,1500,0,02:42:06:b4:62:93,1,1,0:00:24.06,0,0,0,0,0,0,371278,2669,0,0,0,0,0.08,8,br-6a2604a91ac1,6,1500,0,02:42:08:61:d9:06,1,1,0:04:03.11,619193909,2239237,0,0,0,0,534325193,1296045,0,0,0,0,0.012,12,vethef620e8,6,1500,4294967295,e6:ec:86:ac:8e:39,1,1,0:00:24.06,0,0,0,0,0,0,429025,3147,0,0,0,0,0.09,9,docker0,6,1500,0,02:42:13:0a:d8:d8,1,2,0:00:12.06,0,0,0,0,0,0,0,0,0,0,0,0,0.014,14,veth0e23123,6,1500,4294967295,aa:7a:45:ff:6a:9d,1,1,0:03:42.10,2467257,29493,0,0,0,0,2817234,29860,0,0,0,0,0.020,20,vethbfefa92,6,1500,4294967295,5a:85:39:ab:f3:74,1,1,0:04:03.11,325081710,1135008,0,0,0,0,267479252,660748,0,0,0,0,0.016,16,vethdf6bad9,6,1500,4294967295,b2:b5:47:2f:9b:ff,1,1,0:03:51.11,57756751,101171,0,0,0,0,9816144,112533,0,0,0,0,0.022,22,veth697a876,6,1500,4294967295,62:b4:9a:7a:ab:b4,1,1,0:04:15.11,77381757,237753,0,0,0,0,52865894,279409,0,0,0,0,0.05,5,br-ee99fe372436,6,1500,0,02:42:ca:b3:57:b4,1,1,0:03:51.11,56340357,101171,0,0,0,0,9771869,112215,0,0,0,0,0.04,4,virbr0-nic,6,1500,10000000,52:54:00:9b:4b:e0,2,2,0:00:06.05,0,0,0,0,0,0,0,0,0,0,0,0,0.03,3,virbr0,6,1500,0,52:54:00:9b:4b:e0,1,2,0:00:06.05,0,0,0,0,0,0,0,0,0,0,0,0,0.02,2,NVIDIA Corporation MCP77 Ethernet,6,1500,100000000,90:e6:ba:59:1b:18,1,1,0:00:03.05,2228352644,5908706,308678,0,0,0,1270990055,6119330,0,0,0,0,0.01,1,lo,24,65536,10000000,,1,1,0:00:00.00,3162190286,1989856,0,0,0,0,3162190286,1989856,0,0,0,0,0.018,18,veth303d00d,6,1500,4294967295,9a:f5:00:f8:20:49,1,1,0:04:03.11,325461517,1104229,0,0,0,0,267278626,638367,0,0,0,0,0.0
================================================================================


*/
